Theldo, enviei a R02 em C. 
Tive algumas dificuldades e por isso separei as funções assim, principalmente na 3.